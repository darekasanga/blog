<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EMPEROR.NEWS | AI COVEè§£æ</title>
  <link rel="stylesheet" href="../assets/styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="inner">
      <div class="brand">
        <div class="brand-mark" aria-hidden="true"></div>
        <div>
          <p class="brand-kicker">BLOG</p>
          <p class="brand-title" data-site-title>EMPEROR.NEWS</p>
        </div>
      </div>
      <div class="header-actions">
        <nav class="nav-links" aria-label="ãƒ¡ã‚¤ãƒ³ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³">
          <a href="../index.html" class="nav-link">ãƒˆãƒƒãƒ—</a>
          <a href="../admin/login.html?redirect=/analyze/index.html" class="nav-link" data-auth="guest">ãƒ­ã‚°ã‚¤ãƒ³</a>
          <a href="../admin/index.html" class="nav-link" data-auth="auth" hidden>è¨˜äº‹æŠ•ç¨¿</a>
          <a href="../admin/edit.html" class="nav-link" data-auth="auth" hidden>è¨˜äº‹ç·¨é›†</a>
          <a href="index.html" class="nav-link active" data-auth="auth" hidden>AI COVEè§£æ</a>
          <button class="nav-link nav-button" type="button" data-auth="auth" data-action="logout" hidden>ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        </nav>
      </div>
    </div>
  </header>

  <main>
    <section class="section">
      <div class="inner">
        <div class="section-header">
          <div>
            <p class="kicker">AI COVE</p>
            <h1>AI COVEè§£æ</h1>
          </div>
        </div>
        <p class="lead">MFAèªè¨¼å¾Œã«ã€è§£æå¯¾è±¡ã®è¨˜äº‹ã¨è£œæ­£ãƒã‚¤ãƒ³ãƒˆã‚’è¨˜éŒ²ã§ãã¾ã™ã€‚</p>
        <div class="analysis-mode">
          <p class="kicker">è§£æãƒ¢ãƒ¼ãƒ‰</p>
          <div class="preview-mode-picker" role="group" aria-label="è§£æãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ¢ãƒ¼ãƒ‰">
            <button class="mode-button is-active" type="button" data-analysis-mode="frame" aria-pressed="true">
              <span class="mode-icon mode-icon-frame" aria-hidden="true"></span>
              <span>æ–‡å­—æ æŒ‡å®š</span>
            </button>
            <button class="mode-button" type="button" data-analysis-mode="pen" aria-pressed="false">
              <span class="mode-icon mode-icon-pen" aria-hidden="true"></span>
              <span>èµ¤ãƒšãƒ³</span>
            </button>
          </div>
        </div>
        <div class="analysis-handwriting" aria-live="polite">
          <p class="kicker">æ‰‹æ›¸ãåˆ¤å®š</p>
          <p class="muted-text" id="handwriting-status" data-handwriting="clear">æ‰‹æ›¸ãåˆ¤å®šãªã—</p>
        </div>

        <div class="analysis-editor">
          <section class="analysis-panel handwriting-panel" data-panel-role="handwriting" aria-labelledby="analysis-source-title">
            <div>
              <p class="kicker">Handwriting</p>
              <h2 id="analysis-source-title">æ‰‹æ›¸ãæ–‡å­—</h2>
              <p class="muted-text">å·¦å´ã«æ‰‹æ›¸ãæ–‡å­—ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦è¨˜éŒ²ã—ã¾ã™ã€‚</p>
            </div>
            <label for="analysis-source" class="field">
              <span>æœ¬æ–‡</span>
              <textarea id="analysis-source" name="analysis-source" rows="12" placeholder="è§£æå¯¾è±¡ã®æ–‡ç« ã‚’å…¥åŠ›"></textarea>
            </label>
          </section>

          <section class="analysis-panel correction-panel" data-panel-role="analysis" aria-labelledby="analysis-correction-title">
            <div>
              <p class="kicker">Analysis</p>
              <h2 id="analysis-correction-title">è§£æãƒ¡ãƒ¢</h2>
              <p class="muted-text">å³å´ã«è§£æã®è£œè¶³ã‚„ä¿®æ­£ãƒã‚¤ãƒ³ãƒˆã‚’ã¾ã¨ã‚ã¾ã™ã€‚</p>
            </div>
            <label for="analysis-correction" class="field">
              <span>è£œæ­£å†…å®¹</span>
              <textarea id="analysis-correction" name="analysis-correction" rows="12" placeholder="ä¿®æ­£ã—ãŸã„ãƒã‚¤ãƒ³ãƒˆã‚’å…¥åŠ›"></textarea>
            </label>
          </section>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="inner footer-grid">
      <div>
        <p class="brand-title" data-site-title>EMPEROR.NEWS</p>
        <p class="muted-text" data-footer-description>ã‚·ãƒ³ãƒ—ãƒ«ã§çµ±ä¸€æ„Ÿã®ã‚ã‚‹ãƒ–ãƒ­ã‚°ä½“é¨“ã‚’å±Šã‘ã¾ã™ã€‚</p>
      </div>
      <div id="site-theme-picker" class="footer-theme-picker" aria-label="è¡¨ç¤ºãƒ†ãƒ¼ãƒé¸æŠ"></div>
    </div>
  </footer>

  <script src="../assets/header-auth.js"></script>
  <script src="../assets/analyze.js"></script>
  <script>
    (() => {
      const sourceInput = document.getElementById('analysis-source');
      const correctionInput = document.getElementById('analysis-correction');
      const status = document.getElementById('handwriting-status');

      if (!sourceInput || !correctionInput || !status) return;

      const keywordRegex = /(æ‰‹æ›¸ã|ç›´ç­†|æ‰‹æã|èµ°ã‚Šæ›¸ã|ãƒ©ãƒ•)/;
      const symbolRegex = /[âœâœâœâœğŸ–ŠğŸ–‹ğŸ–]/;
      const markerRegex = /(\[æ‰‹æ›¸ã\]|\(æ‰‹æ›¸ã\)|ï¼ˆæ‰‹æ›¸ãï¼‰|æ‰‹æ›¸ã[:ï¼š])/;

      const detectHandwriting = (text) => {
        const trimmed = text.trim();
        if (!trimmed) return false;
        return keywordRegex.test(trimmed) || symbolRegex.test(trimmed) || markerRegex.test(trimmed);
      };

      const updateStatus = () => {
        const combinedText = `${sourceInput.value}\n${correctionInput.value}`;
        const hasHandwriting = detectHandwriting(combinedText);
        status.dataset.handwriting = hasHandwriting ? 'suspected' : 'clear';
        status.textContent = hasHandwriting ? 'æ‰‹æ›¸ãã®å¯èƒ½æ€§ã‚ã‚Š' : 'æ‰‹æ›¸ãåˆ¤å®šãªã—';
      };

      sourceInput.addEventListener('input', updateStatus);
      correctionInput.addEventListener('input', updateStatus);
      updateStatus();
    })();
  </script>
</body>
</html>
